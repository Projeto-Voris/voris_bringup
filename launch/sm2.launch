<launch>
  <node name="stim300driver" pkg="driver_stim300" type="stim300_driver_node" />
  <param name = "device_name" value="/dev/ttyUSB0" type="string" />
  <param name = "stanard_deviation_of_gyro" value="0.0004" type="double" />
  <param name = "stanard_deviation_of_acc" value="0.004" type="double" />
  <param name = "sample_rate" value="125" type="double" />

   <!-- Common parameters -->
  <arg name="camera_name"               default="SM2" />

  <!-- When unspecified, the driver will use the default framerate as given by the
      camera itself. Use the parameter 'control_frame_rate' to enable manual frame 
      rate control, and 'frame_rate' to set the frame rate value. -->
  <arg name="control_frame_rate"        default="false" />
  <arg name="frame_rate"                default="60" />

  <arg name="left_camera_serial"        default="16378753" />
  <arg name="left_camera_calibrated"    default="0" />

  <arg name="right_camera_serial"       default="16378754" />
  <arg name="right_camera_calibrated"   default="0" />

  <arg name="run_stereo_image_proc"     default="false" />
  <arg name="encoding"                  default="Mono8" />  
  <!-- Nodelet manager -->
  <!-- Both cameras are not loaded into one nodelet manager to avoid the namespacing issue. -->
  <node pkg="nodelet" type="nodelet" name="camera_nodelet_manager" args="manager" />

  <group ns="$(arg camera_name)" >
    <group ns="left" >
      <!-- Camera nodelet -->
      <node pkg="nodelet" type="nodelet" name="camera_nodelet"
            args="load spinnaker_camera_driver/SpinnakerCameraNodelet /camera_nodelet_manager" >
        <param name="frame_id"                        value="camera_left" />
        <param name="serial"                          value="$(arg left_camera_serial)" />

        <!-- Frame rate -->
        <param name="acquisition_frame_rate_enable"   value="$(arg control_frame_rate)" />
        <param name="acquisition_frame_rate"          value="$(arg frame_rate)" />
        <param name="image_format_color_coding"       value="$(arg encoding)" />
        <param name="image_format_y_binning"          value="2" />
        <param name="image_format_x_binning"          value="2" />

        <!-- Use the camera_calibration package to create this file -->
        <param name="camera_info_url" if="$(arg left_camera_calibrated)"
               value="file://$(env HOME)/.ros/camera_info/$(arg left_camera_serial).yaml" />
      </node>

    </group>

    <group ns="right" >
      <!-- Camera nodelet -->
      <node pkg="nodelet" type="nodelet" name="camera_nodelet"
            args="load spinnaker_camera_driver/SpinnakerCameraNodelet /camera_nodelet_manager" >
        <param name="frame_id"                        value="camera_right" />
        <param name="serial"                          value="$(arg right_camera_serial)" />

        <!-- Frame rate -->
        <param name="acquisition_frame_rate_enable"   value="$(arg control_frame_rate)" />
        <param name="acquisition_frame_rate"          value="$(arg frame_rate)" />
        <param name="image_format_color_coding"       value="$(arg encoding)" />
        <param name="image_format_y_binning"          value="2" />
        <param name="image_format_x_binning"          value="2" />

        <!-- Use the camera_calibration package to create this file -->
        <param name="camera_info_url" if="$(arg right_camera_calibrated)"
               value="file://$(env HOME)/.ros/camera_info/$(arg right_camera_serial).yaml" />
      </node>

      <!-- Debayering nodelet -->
    </group>
  </group>
</launch>